%% fixture_id: state_stress
%% purpose: stress test with deep composite nesting, many transitions, forks, choices
stateDiagram-v2
  [*] --> Idle
  Idle --> Processing: start
  state Processing {
    [*] --> Validating
    Validating --> Transforming: valid
    Validating --> Error: invalid
    state Transforming {
      [*] --> Step1
      Step1 --> Step2
      Step2 --> Step3
      state Step3 {
        [*] --> SubA
        SubA --> SubB
        SubB --> SubC
        SubC --> [*]
      }
      Step3 --> [*]
    }
    Transforming --> Saving
    Saving --> [*]
    Error --> [*]
  }
  Processing --> Complete: done
  Processing --> Failed: error
  Complete --> [*]
  Failed --> Idle: retry
  Failed --> [*]: abandon
  note right of Processing: Deep composite state
  note left of Failed
    Multi-line note
    with extra detail
  end note
